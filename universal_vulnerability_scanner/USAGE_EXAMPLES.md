# ðŸ“š Usage Examples - Universal Vulnerability Scanner

Complete examples for common use cases.

---

## ðŸŽ¯ Basic Scanning

### Example 1: Scan Current Directory
```bash
cd /path/to/your/project
python -m universal_vulnerability_scanner.main scan .
```

**Output:**
```
ðŸ“‚ Loading vulnerability database
âœ… Loaded 6 vulnerabilities
ðŸ” Scanning: .
âœ… Scan complete: 15 findings

================================================================================
UNIVERSAL VULNERABILITY SCANNER REPORT
================================================================================
Scan completed: 2025-12-04 11:45:00

SUMMARY:
  VULNERABLE:  3
  SAFE:        2
  CLEAN:       10
```

---

### Example 2: Scan Specific Directory
```bash
python -m universal_vulnerability_scanner.main scan /Users/dev/my-react-app
```

---

### Example 3: Scan with Custom Database
```bash
python -m universal_vulnerability_scanner.main scan . \
    --database /path/to/custom_vulnerabilities.json
```

---

## ðŸ“„ Output Formats

### Example 4: JSON Output
```bash
python -m universal_vulnerability_scanner.main scan . \
    --json --output scan-results.json
```

**Generated JSON:**
```json
[
  {
    "path": "/path/to/package.json",
    "kind": "package.json",
    "package": "react-server-dom-webpack",
    "version": "19.0.0",
    "verdict": "VULNERABLE",
    "severity": "CRITICAL",
    "cve_ids": ["CVE-2025-RSC-001"],
    "safe_version": "19.0.1+"
  }
]
```

---

### Example 5: Quiet Mode (CI/CD)
```bash
python -m universal_vulnerability_scanner.main scan . --quiet

# Exit code 0 = no vulnerabilities
# Exit code 1 = vulnerabilities found
```

**Output:**
```
SUMMARY:
  VULNERABLE:  3
  SAFE:        2
  CLEAN:       10
```

---

## ðŸ” Phoenix Security Integration

### Example 6: Create Phoenix Configuration
```bash
# Step 1: Generate template
python -m universal_vulnerability_scanner.main create-config

# Step 2: Copy and edit
cp .phoenix.config.TEMPLATE .phoenix.config
nano .phoenix.config
```

**Edit `.phoenix.config`:**
```ini
[phoenix]
client_id = abc123xyz
client_secret = secret456def
api_base_url = https://api.securityphoenix.cloud
assessment_name = My Project Security Scan
```

---

### Example 7: Scan and Upload to Phoenix
```bash
python -m universal_vulnerability_scanner.main scan . --upload-phoenix
```

**Output:**
```
ðŸ” Loaded Phoenix config from .phoenix.config
âœ… Obtained Phoenix API access token
ðŸš€ Uploading 15 findings to Phoenix...
âœ… Successfully uploaded to Phoenix Security
```

---

### Example 8: Debug Mode (Save Payloads)
```bash
python -m universal_vulnerability_scanner.main scan . \
    --upload-phoenix --debug
```

**Creates:**
- `debug/phoenix_payload_20251204_114500.json`
- `debug/phoenix_response_20251204_114500.json`

---

## ðŸ§ª Testing

### Example 9: Run Built-in Tests
```bash
python -m universal_vulnerability_scanner.main test
```

**Output:**
```
ðŸ§ª Running tests on sample data...
âœ… Scan complete: 34 findings

Test Results:
  rsc_vulnerable_exact:  4 VULNERABLE âœ…
  rsc_vulnerable_range:  4 VULNERABLE âœ…
  rsc_safe_versions:     6 SAFE âœ…
  rsc_mixed:             2 VULNERABLE, 1 SAFE, 4 CLEAN âœ…
  rsc_with_lockfile:     2 VULNERABLE âœ…
```

---

### Example 10: Test Specific Scenario
```bash
python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/rsc_vulnerable_exact/
```

---

## ðŸ”„ CI/CD Integration

### Example 11: GitHub Actions
```yaml
name: Security Scan

on: [push, pull_request]

jobs:
  vulnerability-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      
      - name: Install Scanner
        run: |
          pip install -r universal_vulnerability_scanner/requirements.txt
      
      - name: Run Vulnerability Scan
        run: |
          python -m universal_vulnerability_scanner.main scan . \
            --json --output scan-results.json
      
      - name: Upload Results
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: vulnerability-scan-results
          path: scan-results.json
      
      - name: Fail on Vulnerabilities
        run: |
          python -m universal_vulnerability_scanner.main scan . --quiet
```

---

### Example 12: GitLab CI
```yaml
vulnerability_scan:
  stage: test
  image: python:3.9
  script:
    - pip install -r universal_vulnerability_scanner/requirements.txt
    - python -m universal_vulnerability_scanner.main scan . --json --output scan-results.json
  artifacts:
    paths:
      - scan-results.json
    when: always
  allow_failure: false
```

---

### Example 13: Jenkins Pipeline
```groovy
pipeline {
    agent any
    stages {
        stage('Vulnerability Scan') {
            steps {
                sh '''
                    pip install -r universal_vulnerability_scanner/requirements.txt
                    python -m universal_vulnerability_scanner.main scan . \
                        --json --output scan-results.json
                '''
            }
        }
        stage('Upload to Phoenix') {
            when {
                branch 'main'
            }
            steps {
                withCredentials([
                    string(credentialsId: 'phoenix-client-id', variable: 'PHOENIX_CLIENT_ID'),
                    string(credentialsId: 'phoenix-client-secret', variable: 'PHOENIX_CLIENT_SECRET')
                ]) {
                    sh '''
                        export PHOENIX_API_URL="https://api.securityphoenix.cloud"
                        python -m universal_vulnerability_scanner.main scan . --upload-phoenix
                    '''
                }
            }
        }
    }
}
```

---

## ðŸ” Advanced Scenarios

### Example 14: Scan Multiple Projects
```bash
#!/bin/bash
# scan-all-projects.sh

PROJECTS=(
    "/path/to/project1"
    "/path/to/project2"
    "/path/to/project3"
)

for project in "${PROJECTS[@]}"; do
    echo "Scanning: $project"
    python -m universal_vulnerability_scanner.main scan "$project" \
        --json --output "${project##*/}-scan.json"
done
```

---

### Example 15: Environment Variable Configuration
```bash
# Set Phoenix credentials via environment
export PHOENIX_CLIENT_ID="your_client_id"
export PHOENIX_CLIENT_SECRET="your_client_secret"
export PHOENIX_API_URL="https://api.securityphoenix.cloud"
export PHOENIX_ASSESSMENT_NAME="Automated Security Scan"

# Scan without config file
python -m universal_vulnerability_scanner.main scan . --upload-phoenix
```

---

### Example 16: Pre-commit Hook
```bash
#!/bin/bash
# .git/hooks/pre-commit

echo "Running vulnerability scan..."
python -m universal_vulnerability_scanner.main scan . --quiet

if [ $? -ne 0 ]; then
    echo "âŒ Vulnerabilities detected! Commit blocked."
    echo "Run 'python -m universal_vulnerability_scanner.main scan .' for details"
    exit 1
fi

echo "âœ… No vulnerabilities detected"
exit 0
```

Make executable:
```bash
chmod +x .git/hooks/pre-commit
```

---

### Example 17: Weekly Security Audit
```bash
#!/bin/bash
# weekly-security-audit.sh

DATE=$(date +%Y-%m-%d)
REPORT_DIR="security-reports/$DATE"

mkdir -p "$REPORT_DIR"

# Scan with detailed report
python -m universal_vulnerability_scanner.main scan . \
    --output "$REPORT_DIR/vulnerability-report.txt"

# Generate JSON for processing
python -m universal_vulnerability_scanner.main scan . \
    --json --output "$REPORT_DIR/vulnerability-data.json"

# Upload to Phoenix
python -m universal_vulnerability_scanner.main scan . \
    --upload-phoenix --debug

# Move debug files
mv debug/* "$REPORT_DIR/" 2>/dev/null || true

echo "Security audit complete: $REPORT_DIR"
```

---

### Example 18: Docker Container Scan
```dockerfile
# Dockerfile.security-scan
FROM python:3.9-slim

WORKDIR /app

COPY universal_vulnerability_scanner/ /app/universal_vulnerability_scanner/
COPY . /scan-target/

RUN pip install -r universal_vulnerability_scanner/requirements.txt

CMD ["python", "-m", "universal_vulnerability_scanner.main", "scan", "/scan-target"]
```

**Usage:**
```bash
docker build -f Dockerfile.security-scan -t vuln-scanner .
docker run --rm vuln-scanner
```

---

### Example 19: Slack Notification Integration
```bash
#!/bin/bash
# scan-and-notify.sh

SLACK_WEBHOOK="https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

# Run scan
python -m universal_vulnerability_scanner.main scan . \
    --json --output scan-results.json --quiet

VULNERABLE_COUNT=$(jq '[.[] | select(.verdict=="VULNERABLE")] | length' scan-results.json)

if [ "$VULNERABLE_COUNT" -gt 0 ]; then
    MESSAGE="ðŸš¨ Security Alert: $VULNERABLE_COUNT vulnerabilities detected!"
    curl -X POST -H 'Content-type: application/json' \
        --data "{\"text\":\"$MESSAGE\"}" \
        "$SLACK_WEBHOOK"
fi
```

---

### Example 20: Monorepo Scanning
```bash
#!/bin/bash
# scan-monorepo.sh

# Find all package.json files (excluding node_modules)
find . -name "package.json" -not -path "*/node_modules/*" | while read pkg; do
    DIR=$(dirname "$pkg")
    echo "Scanning: $DIR"
    
    python -m universal_vulnerability_scanner.main scan "$DIR" \
        --json --output "${DIR//\//_}-scan.json"
done

# Combine results
jq -s 'add' *-scan.json > combined-scan-results.json
```

---

## ðŸ“Š Report Processing

### Example 21: Parse JSON Results
```python
#!/usr/bin/env python3
# process-scan-results.py

import json
import sys

with open('scan-results.json', 'r') as f:
    findings = json.load(f)

vulnerable = [f for f in findings if f['verdict'] == 'VULNERABLE']
critical = [f for f in vulnerable if f['severity'] == 'CRITICAL']

print(f"Total findings: {len(findings)}")
print(f"Vulnerable: {len(vulnerable)}")
print(f"Critical: {len(critical)}")

if critical:
    print("\nCritical vulnerabilities:")
    for f in critical:
        print(f"  - {f['package']}@{f['version']}")
    sys.exit(1)

sys.exit(0)
```

---

### Example 22: Generate HTML Report
```bash
# Convert JSON to HTML
python -m universal_vulnerability_scanner.main scan . \
    --json --output scan-results.json

# Use jq and pandoc to create HTML
jq -r '.[] | "## \(.package)@\(.version)\n\n**Verdict**: \(.verdict)\n\n**Reason**: \(.reason)\n\n---\n"' \
    scan-results.json | pandoc -o security-report.html
```

---

## ðŸŽ¯ Real-World Scenarios

### Example 23: React App Migration
```bash
# Before upgrading React 19
python -m universal_vulnerability_scanner.main scan . --quiet

# Check specific RSC packages
grep -E "react-server-dom" scan-results.json

# After upgrade, verify safety
python -m universal_vulnerability_scanner.main scan . --output post-upgrade-scan.txt
```

---

### Example 24: Dependency Audit
```bash
# Full audit with Phoenix upload
python -m universal_vulnerability_scanner.main scan . \
    --upload-phoenix \
    --output "audit-$(date +%Y%m%d).txt"

# Review clean packages
grep "CLEAN" "audit-$(date +%Y%m%d).txt"
```

---

## ðŸ’¡ Tips & Tricks

### Tip 1: Faster Scans
```bash
# Scan only specific directories
python -m universal_vulnerability_scanner.main scan ./src
```

### Tip 2: Compare Scans
```bash
# Before changes
python -m universal_vulnerability_scanner.main scan . --json --output before.json

# After changes
python -m universal_vulnerability_scanner.main scan . --json --output after.json

# Compare
diff <(jq -S . before.json) <(jq -S . after.json)
```

### Tip 3: Filter Results
```bash
# Only show VULNERABLE findings
python -m universal_vulnerability_scanner.main scan . --json | \
    jq '.[] | select(.verdict=="VULNERABLE")'
```

---

**ðŸ” More examples? Check the test samples in `test_samples/` directory!**



# üöÄ Quick Start Guide - Universal Vulnerability Scanner

## Installation & Setup (2 minutes)

### 1. Install Dependencies
```bash
cd universal_vulnerability_scanner
pip install -r requirements.txt
```

### 2. Verify Installation
```bash
python -m universal_vulnerability_scanner.main --help
```

You should see the help menu with available commands.

---

## Basic Usage

### Scan Your First Project

```bash
# Navigate to your project's root directory
cd /path/to/your/project

# Run scan
python -m universal_vulnerability_scanner.main scan .

# Or scan from anywhere by specifying path
python -m universal_vulnerability_scanner.main scan /path/to/project
```

**Expected Output:**
```
üìÇ Loading vulnerability database: .../vulnerability_database.json
‚úÖ Loaded 6 vulnerabilities
üîç Scanning: /path/to/project
‚úÖ Scan complete: 12 findings

================================================================================
UNIVERSAL VULNERABILITY SCANNER REPORT
================================================================================
...
```

---

## Test the Scanner

### Run Included Tests

The scanner comes with pre-built test cases:

```bash
python -m universal_vulnerability_scanner.main test
```

This will scan the `test_samples/` directory containing:
- ‚úÖ **Vulnerable packages** (should be detected)
- ‚úÖ **Safe packages** (should pass)
- ‚úÖ **Mixed scenarios** (should classify correctly)

---

## Output Options

### 1. Text Report (Default)

```bash
python -m universal_vulnerability_scanner.main scan . --output report.txt
```

### 2. JSON Report

```bash
python -m universal_vulnerability_scanner.main scan . --json --output results.json
```

Perfect for:
- CI/CD pipelines
- Automated processing
- Integration with other tools

### 3. Quiet Mode

```bash
python -m universal_vulnerability_scanner.main scan . --quiet
```

Only shows:
- Summary statistics
- Critical findings
- No verbose output

---

## Phoenix Security Integration

### ‚úÖ Your Phoenix is Already Configured!

Your `.phoenix.config` is ready to use with:
- **API**: https://api.demo.appsecphx.io
- **Assessment**: NPM Compromise Detection - Local Scan

### Quick Scan & Upload Examples

#### 1. Scan Vulnerable Sample (Will Find Issues)
```bash
cd /Users/francescocipollone/Documents/GitHub/Shai-Halud-tinycolour-compromise-verifier

python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/rsc_vulnerable_exact/ \
    --upload-phoenix
```

**Expected**: 4 CRITICAL findings uploaded to Phoenix

#### 2. Scan Safe Versions (Clean Results)
```bash
cd /Users/francescocipollone/Documents/GitHub/Shai-Halud-tinycolour-compromise-verifier

python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/clean_safe_versions/ \
    --upload-phoenix
```

**Expected**: 27 INFO findings uploaded to Phoenix

#### 3. Scan All Test Samples
```bash
cd /Users/francescocipollone/Documents/GitHub/Shai-Halud-tinycolour-compromise-verifier

python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/ \
    --upload-phoenix
```

**Expected Output:**
```
üîê Loaded Phoenix config from .phoenix.config
‚úÖ Obtained Phoenix API access token
üöÄ Uploading findings to Phoenix...
‚úÖ Successfully uploaded to Phoenix Security
üìä View at: https://api.demo.appsecphx.io
```

### See More Examples
Check `PHOENIX_SCAN_EXAMPLES.md` for detailed library-specific scan examples!

---

## What Gets Detected?

### React Server Components (RSC)

**Vulnerable Versions:**
- `react-server-dom-webpack@19.0.0`, `19.1.0`, `19.1.1`, `19.2.0`
- `react-server-dom-parcel@19.0.0`, `19.1.0`, `19.1.1`, `19.2.0`
- `react-server-dom-turbopack@19.0.0`, `19.1.0`, `19.1.1`, `19.2.0`

**Safe Versions:**
- `19.0.1+`, `19.1.2+`, `19.2.1+`

### React Core

**Vulnerable Ranges:**
- `react` / `react-dom`: [19.0.0, 19.0.1), [19.1.0, 19.1.2), [19.2.0, 19.2.1)

### Next.js

**Vulnerable Ranges:**
- [15.0.0, 15.0.5), [16.0.0, 16.0.7)

---

## Understanding Results

### Verdict Types

| Verdict | Meaning | Action Required |
|---------|---------|-----------------|
| **VULNERABLE** | Confirmed vulnerable version | üö® IMMEDIATE - Update/remove |
| **SAFE** | Safe version of monitored package | ‚úÖ OK - Continue monitoring |
| **CLEAN** | Not in vulnerability database | ‚úÖ OK - No known issues |
| **REVIEW** | Unparseable or needs manual check | ‚ö†Ô∏è REVIEW - Investigate |

### Severity Levels

| Severity | Phoenix Score | Description |
|----------|---------------|-------------|
| **CRITICAL** | 10.0 | Confirmed exploit, immediate action |
| **HIGH** | 8.0 | Potentially compromised |
| **MEDIUM** | 6.0 | Suspicious, review needed |
| **LOW** | 3.5 | Low risk |
| **INFO** | 1.0 | Informational |

---

## Common Workflows

### 1. Local Development Check

```bash
# Quick scan before commit
python -m universal_vulnerability_scanner.main scan . --quiet

# Exit code 0 = safe, 1 = vulnerabilities found
```

### 2. CI/CD Integration

```yaml
# .github/workflows/security-scan.yml
- name: Vulnerability Scan
  run: |
    pip install -r universal_vulnerability_scanner/requirements.txt
    python -m universal_vulnerability_scanner.main scan . --json --output scan-results.json
    
- name: Upload Results
  uses: actions/upload-artifact@v3
  with:
    name: vulnerability-scan
    path: scan-results.json
```

### 3. Security Audit

```bash
# Comprehensive scan with all details
python -m universal_vulnerability_scanner.main scan . --output audit-report.txt

# Upload to Phoenix for tracking
python -m universal_vulnerability_scanner.main scan . --upload-phoenix
```

---

## Troubleshooting

### "Vulnerability database not found"

```bash
# Make sure you're in the right directory
cd universal_vulnerability_scanner

# Or specify database path
python -m universal_vulnerability_scanner.main scan /path/to/project \
    --database /path/to/vulnerability_database.json
```

### "Phoenix not configured"

```bash
# Option 1: Create config file
python -m universal_vulnerability_scanner.main create-config
cp .phoenix.config.TEMPLATE .phoenix.config
# Edit .phoenix.config with your credentials

# Option 2: Use environment variables
export PHOENIX_CLIENT_ID="your_id"
export PHOENIX_CLIENT_SECRET="your_secret"
export PHOENIX_API_URL="https://api.securityphoenix.cloud"
```

### "No findings detected" (but you expect some)

- Check if you're scanning the right directory
- Verify `package.json` files exist in the scanned path
- Check `node_modules` is not being scanned (it's automatically skipped)
- Try scanning a test sample: `python -m universal_vulnerability_scanner.main test`

---

## Advanced Features

### Debug Mode

```bash
# Save Phoenix API payloads for debugging
python -m universal_vulnerability_scanner.main scan . \
    --upload-phoenix --debug
```

Creates `debug/` folder with:
- `phoenix_payload_*.json` - Request payload
- `phoenix_response_*.json` - API response

### Custom Database

```bash
# Use your own vulnerability database
python -m universal_vulnerability_scanner.main scan . \
    --database /path/to/custom_vulnerabilities.json
```

---

## Next Steps

1. ‚úÖ **Test the scanner** - Run on test samples
2. ‚úÖ **Scan your projects** - Identify vulnerable dependencies
3. ‚úÖ **Integrate with CI/CD** - Automate security checks
4. ‚úÖ **Set up Phoenix** - Track vulnerabilities centrally
5. ‚úÖ **Update database** - Add new vulnerabilities as they're discovered

---

## Getting Help

- **Documentation**: See `README.md` for full documentation
- **Test Samples**: Check `test_samples/README.md` for test case details
- **Database Format**: See `data/vulnerability_database.json` for structure
- **Phoenix Integration**: See `.phoenix.config.TEMPLATE` for configuration

---

**üîç Happy Scanning! Stay Secure!** üõ°Ô∏è


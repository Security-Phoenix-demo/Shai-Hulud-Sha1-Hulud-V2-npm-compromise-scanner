#!/bin/bash
# Scan @vietmoney packages and upload to Phoenix

cd /Users/francescocipollone/Documents/GitHub/Shai-Halud-tinycolour-compromise-verifier

echo "üö® @vietmoney Supply Chain Attack Scanner + Phoenix Upload"
echo "==========================================================="
echo ""
echo "Scanning for 10 malicious @vietmoney packages..."
echo "Uploading results to Phoenix Security Platform..."
echo ""

# Scan and upload
python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/vietmoney_compromised/ \
    --upload-phoenix \
    --phoenix-config universal_vulnerability_scanner/.phoenix.config

echo ""
echo "=========================================="
echo "‚úÖ Scan Complete + Uploaded to Phoenix!"
echo ""
echo "üîç Check your Phoenix dashboard:"
echo "   https://api.demo.appsecphx.io"
echo ""
echo "Expected Phoenix Results:"
echo "  - Assessment: NPM Compromise Detection - Local Scan"
echo "  - Asset: vietmoney_compromised"
echo "  - Findings: 10 CRITICAL (severity 10.0)"
echo "  - CVE: CVE-2025-VIETMONEY-SUPPLY-CHAIN"
echo ""
echo "Detected packages:"
echo "  ‚úó @vietmoney/react-native-smart-page (1.1.2)"
echo "  ‚úó @vietmoney/react-native-smart-gallery"
echo "  ‚úó @vietmoney/react-native-true-id"
echo "  ‚úó @vietmoney/react-native-tags-input"
echo "  ‚úó @vietmoney/react-native-vnpay-merchant"
echo "  ‚úó @vietmoney/react-native-image-transformer"
echo "  ‚úó @vietmoney/react-native-htmlview"
echo "  ‚úó @vietmoney/react-native-action-button"
echo "  ‚úó @vietmoney/vietmoneywork"
echo "  ‚úó @vietmoney/react-big-calendar (0.26.2)"
echo ""
echo "‚ö†Ô∏è  ALL @vietmoney packages are MALICIOUS"
echo "    Remove immediately if found in production!"
echo ""
echo "üìñ Full threat report:"
echo "   VIETMONEY_SUPPLY_CHAIN_ATTACK.md"
echo ""


# ‚ö†Ô∏è @vietmoney Supply Chain Attack Test Sample

## üö® CRITICAL: Malicious Packages

This test sample contains **KNOWN MALICIOUS PACKAGES** from the @vietmoney supply chain attack.

**DO NOT INSTALL THESE PACKAGES IN A REAL PROJECT!**

---

## üì¶ Malicious Packages Included

This sample includes all 10 compromised packages from the @vietmoney scope:

| Package | Version | Threat Type |
|---------|---------|-------------|
| `@vietmoney/react-native-smart-page` | 1.1.2 | Data Exfiltration |
| `@vietmoney/react-native-smart-gallery` | ^1.0.0 | Data Exfiltration |
| `@vietmoney/react-native-true-id` | ^1.0.0 | Credential Theft |
| `@vietmoney/react-native-tags-input` | ^1.0.0 | Data Exfiltration |
| `@vietmoney/react-native-vnpay-merchant` | ^2.0.0 | Payment Data Theft |
| `@vietmoney/react-native-image-transformer` | ^1.0.0 | Data Exfiltration |
| `@vietmoney/react-native-htmlview` | ^1.0.0 | XSS / Data Exfiltration |
| `@vietmoney/react-native-action-button` | ^1.0.0 | Data Exfiltration |
| `@vietmoney/vietmoneywork` | ^1.0.0 | Credential Theft |
| `@vietmoney/react-big-calendar` | 0.26.2 | Typosquatting / Data Exfiltration |

---

## üéØ Purpose

This test sample is designed to:

1. **Validate Detection**: Ensure the scanner correctly identifies ALL @vietmoney packages as malicious
2. **Test Severity**: Verify all findings are marked as CRITICAL (severity 10.0)
3. **Supply Chain Training**: Demonstrate supply chain attack detection capabilities
4. **Incident Response**: Practice responding to compromised package discoveries

---

## üîç Expected Scanner Results

### When scanning this directory:

```bash
python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/vietmoney_compromised/
```

**Expected Output**:

```
üö® VULNERABLE: 10 packages detected

üì¶ @vietmoney/react-native-smart-page@1.1.2
   Status: VULNERABLE (CRITICAL)
   CVE: CVE-2025-VIETMONEY-SUPPLY-CHAIN
   Description: MALICIOUS PACKAGE - Supply chain attack

üì¶ @vietmoney/react-native-smart-gallery@^1.0.0
   Status: VULNERABLE (CRITICAL)
   CVE: CVE-2025-VIETMONEY-SUPPLY-CHAIN

üì¶ @vietmoney/react-native-true-id@^1.0.0
   Status: VULNERABLE (CRITICAL)
   CVE: CVE-2025-VIETMONEY-SUPPLY-CHAIN

... (7 more packages)
```

---

## üõ°Ô∏è Phoenix Integration

### Upload to Phoenix Security Platform:

```bash
cd /Users/francescocipollone/Documents/GitHub/Shai-Halud-tinycolour-compromise-verifier

python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/vietmoney_compromised/ \
    --upload-phoenix
```

**Expected Phoenix Results**:
- **Total Findings**: 10 CRITICAL
- **Severity**: 10.0 for all findings
- **CVE**: CVE-2025-VIETMONEY-SUPPLY-CHAIN
- **Assessment Name**: NPM Compromise Detection - Local Scan
- **Asset Name**: vietmoney_compromised

---

## üî¥ Threat Intelligence

### Attack Vector
The @vietmoney packages are part of a coordinated supply chain attack targeting:
- **React Native applications**
- **Financial/payment systems** (vnpay-merchant)
- **Authentication systems** (true-id)
- **General data exfiltration** (multiple packages)

### Indicators of Compromise (IOCs)
- **Scope**: @vietmoney/*
- **Attack Type**: Typosquatting + Malicious Code Injection
- **Target Ecosystem**: NPM (React Native)
- **First Seen**: 2025 (estimated)
- **Status**: ACTIVE THREAT

### Typosquatting Example
- **Malicious**: `@vietmoney/react-big-calendar@0.26.2`
- **Legitimate**: `react-big-calendar` (no @vietmoney scope)

---

## ‚ö†Ô∏è Security Warnings

### If Found in Production:

1. **IMMEDIATE ACTION REQUIRED**
   - Quarantine affected systems
   - Do NOT run `npm install` or `yarn install`
   - Do NOT deploy to production

2. **Incident Response Steps**
   ```bash
   # 1. Remove malicious packages
   npm uninstall @vietmoney/react-native-smart-page
   npm uninstall @vietmoney/react-native-smart-gallery
   # ... (all @vietmoney packages)
   
   # 2. Clear caches
   npm cache clean --force
   rm -rf node_modules
   rm package-lock.json
   
   # 3. Reinstall from clean state
   npm install
   
   # 4. Audit
   npm audit
   ```

3. **Forensic Investigation**
   - Check application logs for data exfiltration
   - Review network traffic logs
   - Audit user credentials and API keys
   - Check payment transaction logs (if vnpay-merchant was used)
   - Rotate all secrets/credentials
   - Review git history for malicious commits

4. **Notify**
   - Security team
   - Affected users (if data breach confirmed)
   - Management/stakeholders

---

## üìä Detection Validation

### Test Command:
```bash
# From project root
cd /Users/francescocipollone/Documents/GitHub/Shai-Halud-tinycolour-compromise-verifier

# Test detection
python -m universal_vulnerability_scanner.main scan \
    universal_vulnerability_scanner/test_samples/vietmoney_compromised/ \
    --json-output vietmoney_scan_results.json
```

### Validation Checklist:
- [ ] All 10 packages detected as VULNERABLE
- [ ] All findings marked as CRITICAL (severity 10.0)
- [ ] CVE-2025-VIETMONEY-SUPPLY-CHAIN assigned
- [ ] Descriptions clearly state "MALICIOUS PACKAGE"
- [ ] No false negatives (all packages caught)
- [ ] Phoenix upload successful (if configured)

---

## üîó References

- **CVE**: CVE-2025-VIETMONEY-SUPPLY-CHAIN
- **Socket.dev**: https://socket.dev/npm/package/@vietmoney/
- **Snyk Advisor**: https://snyk.io/advisor/npm-package/@vietmoney/
- **NPM Security**: https://www.npmjs.com/advisories

---

## üìù Notes

- **This is a TEST SAMPLE ONLY** - Never install these packages in production
- All packages in the @vietmoney scope should be considered malicious
- The scanner treats ALL versions of these packages as vulnerable
- No "safe" versions exist - complete removal is the only remediation

---

**Test Sample Status**: ‚úÖ Ready for testing  
**Threat Level**: üî¥ CRITICAL  
**Action**: Detect and Remove

